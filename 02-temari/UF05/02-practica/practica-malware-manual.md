# Manual Resolució Pràctica Malware

## Preparatius Inicials

### Instantània de la Màquina Virtual
1. Inicia la teva màquina virtual Windows.
2. Crea una instantània amb el nom **"Abans de [nom acció]"**.
3. Verifica que la màquina està desconnectada de la xarxa:
   - Desactiva l’adaptador de xarxa des de la configuració de VirtualBox.
   - Comprova que no hi ha connexió a Internet.

### Configuració Inicial
1. Assegura’t que el navegador Windows té les proteccions antimalware desactivades per fer les proves.
2. Desactiva l’antimalware de Windows temporalment:
   - Ves a **Configuració > Actualització i seguretat > Seguretat de Windows**.
   - Desactiva les opcions de protecció en temps real.

---

## Verificar Funcionament d’Antimalware a Windows

### 1. Selecció d’un Antimalware
1. Busca a Internet una llista actualitzada dels **10 millors antimalware**.
   - Recomano webs com **AV-Test** o **TechRadar** per trobar informació fiable.
2. Escull un programa antimalware gratuït (per exemple, **Malwarebytes**).
3. Justifica la teva elecció amb arguments:
   - **Exemple:** Malwarebytes és conegut per detectar ransomware de forma eficient i és molt fàcil d’utilitzar.

### 2. Instal·lació de l’Antimalware
1. Baixa el fitxer d’instal·lació des de la web oficial.
2. Executa l’instal·lador i segueix els passos.
3. Comprova que el programa estigui actualitzat.

### 3. Prova amb el Test EICAR
1. Ves al web oficial d’EICAR (**https://www.eicar.org**).
2. Baixa el fitxer de prova EICAR:
   - Si el navegador bloqueja la descàrrega, desactiva la detecció temporalment.
   - **Nota:** Explica com ho has fet.
3. Activa l’antimalware i comprova si detecta el fitxer EICAR.

### 4. Compressió del Test EICAR
1. Torna a desactivar la detecció en temps real.
2. Comprimeix el fitxer EICAR en diferents formats:
   - **zip, tar.gz, 7z, arj**.
3. Activa l’antimalware i comprova si detecta el fitxer en cada format.
   - Apunta els resultats.

---

## Test de Malware Real a Windows

### 1. Investigació sobre WannaCry
1. Llegeix la informació de **https://www.avg.com/es/signal/wannacry-ransomware-what-you-need-to-know**.

2. Respon aquestes preguntes:
- **Perquè WannaCry es propaga tan ràpidament? Explica-ho amb claredat**.
    Explotació automàtica: WannaCry utilitza l’exploit EternalBlue, desenvolupat inicialment per la NSA i filtrat per un grup de hackers. Aquest exploit permet accedir al sistema sense permisos, aprofitant la vulnerabilitat SMBv1.

    Propagació en xarxa: Un cop infecta un dispositiu, WannaCry cerca altres dispositius vulnerables dins de la mateixa xarxa i reprodueix el cicle d’infecció. Això el converteix en un cuc (worm), capaç de propagar-se de manera exponencial.

    Manca d'actualitzacions: Molts equips afectats no havien aplicat els pegats de seguretat publicats per Microsoft (MS17-010), deixant-los vulnerables al ransomware.

    Connexions globals: WannaCry pot propagar-se a través d'internet mitjançant equips connectats, infectant xarxes a escala global.

    Aquests factors combinats expliquen per què WannaCry va provocar un impacte tan massiu en tan poc temps. La seva propagació va ser especialment greu en empreses, hospitals i organitzacions amb sistemes crítics que no havien estat actualitzats adequadament.

- **Quina és la vulnerabilitat CVE-2017-0144 i per què és tan greu?**
    En resum, CVE-2017-0144 és tan greu perquè permet atacs massius sense necessitat d'interacció humana, afectant sistemes crítics de manera ràpida i global. Aquesta vulnerabilitat va posar en evidència la importància d’aplicar actualitzacions de seguretat de manera proactiva.

- **S'ha de pagar el rescat demanat? Per què?**
    En resum, pagar el rescat no és una solució fiable i contribueix a alimentar el cicle de cibercriminalitat. Sempre és millor centrar-se en mesures preventives i mètodes de recuperació ètics.

    1. *Cap garantia de recuperar els fitxers*
    Tot i que el ransomware promet desencriptar els fitxers si es paga el rescat, no hi ha cap garantia que això passi realment. Molts usuaris han informat que no han rebut la clau de desencriptació després de pagar.

    2. *Fomentar activitats il·lícites*
    Pagar el rescat incentiva els cibercriminals a continuar desenvolupant i llançant atacs similars, ja que els proporciona beneficis econòmics directes.

    3. *Alt risc d’infecció repetida*
    Encara que es desencriptin els fitxers, si el sistema no s’ha actualitzat ni s’han aplicat les mesures de seguretat adequades, l’ordinador pot ser infectat de nou pel mateix ransomware o per altres variants.

    4. *Traçabilitat limitada dels pagaments*
    Els pagaments en Bitcoin, el mètode utilitzat per WannaCry, són difícils de rastrejar, i els cibercriminals poden desaparèixer sense deixar rastre.

    5. *Existeixen alternatives per recuperar fitxers*
    En molts casos, és millor explorar altres opcions com utilitzar còpies de seguretat, eines de desencriptació disponibles o restaurar el sistema des d’una instantània prèvia a l’atac.


### 2. Preparació per Provar Malware Real
1. Baixa WannaCry i TeslaCrypt des de **https://github.com/ytisf/theZoo**.
2. Verifica que els fitxers estan comprimits amb contrasenya.
Estan comprimits però sense contrasenya
3. Desconnecta la xarxa de la màquina virtual i assegura’t que no hi ha carpetes compartides.

- instal.la git -> git-scm/downloads/win
- instal.la python 3.8
- instal.la Microsoft Visual C++ Build Tools
    - C++ build tools.
    - MSVC v142 - VS 2019 C++ x64/x86 build tools.
    - Windows 10 SDK. 
- VBoxManage modifymedium "/home/el_teu_usuari/VirtualBox VMs/Ubuntu/Ubuntu.vdi" --resize 51200 -> en MB
- apaga màquina i torna a obrir
- crea carpeta on vols posar el el programa virus
- 

### 3. Execució del Malware
1. Crea una carpeta amb el teu nom a l’escriptori i afegeix-hi fitxers de prova.
2. Desactiva l’antimalware i executa WannaCry:
   - Mira si els fitxers han estat xifrats.
   - Fes una captura del missatge de rescat.
3. Restaura la instantània creada abans.
4. Repeteix el procés amb TeslaCrypt.

### 4. Anàlisi de Malware
1. Envia els fitxers a **https://www.virustotal.com** i altres eines d’anàlisi.
2. Apunta quins antivirus detecten el malware i quins no.

### 5. Mesures de Prevenció
1. **Abans de l’atac:**
   - Manté el sistema actualitzat.
   - Desactiva SMBv1 si no és necessari.
   - Fes còpies de seguretat periòdiques.
2. **Després de l’atac:**
   - Desconnecta immediatament la xarxa.
   - Busca eines de desencriptació disponibles.

---

## Antimalware a Linux

### 1. Necessitat d’Antimalware
1. Investiga si cal tenir antimalware a Linux.
   - Per exemple, “Linux té menys malware, però és necessari si es treballa amb serveis compartits o fitxers de tercers”.

### 2. Instal·lació d’un Antimalware
1. Escull un programa com ClamAV.
2. Baixa’l i instal·la’l seguint les instruccions.

### 3. Prova amb EICAR
1. Executa una prova de detecció amb el fitxer EICAR.
2. Revisa els fitxers de registre i anota els resultats.



